var t,e,s=Object.defineProperty,a=Object.prototype.hasOwnProperty,r=Object.getOwnPropertySymbols,l=Object.prototype.propertyIsEnumerable,o=(t,e,a)=>e in t?s(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,i=(t,e)=>{for(var s in e||(e={}))a.call(e,s)&&o(t,s,e[s]);if(r)for(var s of r(e))l.call(e,s)&&o(t,s,e[s]);return t};import{reactive as n,computed as c,watch as u,defineComponent as d,provide as h,toRef as g,h as p,inject as f,ref as v,onMounted as P,nextTick as y,isVue2 as w,install as S}from"vue-demi";function m(t,e){const s=(e=(e=e.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split(".");let a=t;for(const r of s){if(!(r in a))return;a=a[r]}return a}function b(t){return!Array.isArray(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function C(t,e){if(function(t){return t&&"function"==typeof t.custom}(e)&&!e.custom(e.value,t))return!1;if(!function(t){return Array.isArray(t.keys)}(e)||null===e.value||void 0===e.value||0===e.value.length)return!0;for(const s of e.keys){const a=m(t,s);if(null!=a){const t=Array.isArray(e.value)?e.value:[e.value];for(const s of t)if(e.exact){if(a.toString()===s.toString())return!0}else if(a.toString().toLowerCase().includes(s.toString().toLowerCase()))return!0}}return!1}(e=t||(t={}))[e.DESC=-1]="DESC",e[e.NONE=0]="NONE",e[e.ASC=1]="ASC";class R{constructor(e){this.state=n({data:[],filters:{},selectedRows:[],selectionMode:"single",selectOnClick:!0,selectedClass:"",hideSortIcons:!1,sortId:null,sortKey:null,customSort:null,sortOrder:t.NONE,currentPage:0,pageSize:void 0,sortIconPosition:"after",sortHeaderClass:""}),this.emit=e,this.filteredData=c((()=>0===this.state.data.length?[]:0===Object.keys(this.state.filters).length?this.state.data:function(t,e){const s=[];for(const a of t){let t=!0;for(const s of Object.keys(e))if(!C(a,e[s])){t=!1;break}t&&s.push(a)}return s}(this.state.data,this.state.filters))),this.sortedData=c((()=>{return(this.state.sortKey||this.state.customSort)&&0!==this.state.sortOrder?(t=this.filteredData.value,e=this.state.sortKey,s=this.state.customSort,a=this.state.sortOrder,[...t].sort(((t,r)=>{if("function"==typeof s)return s(t,r,a);let l,o;if(e?"function"==typeof e?(l=e(t,a),o=e(r,a)):(l=m(t,e),o=m(r,e)):(l=null,o=null),null==l&&(l=""),null==o&&(o=""),b(l)&&b(o))return(l-o)*a;const i=l.toString(),n=o.toString();return i.localeCompare(n)*a}))):this.filteredData.value;var t,e,s,a})),this.totalItems=c((()=>this.filteredData.value.length)),this.totalPages=c((()=>{return this.state.pageSize?(t=this.totalItems.value,e=this.state.pageSize,t<=e?1:Math.ceil(t/e)):0;var t,e})),u(this.totalPages,(t=>{this.emit("totalPagesChanged",t)}),{immediate:!0}),this.paginationEnabled=c((()=>this.state.pageSize));const s=c((()=>this.paginationEnabled.value&&this.state.currentPage>this.totalPages.value));u(s,(t=>{t&&this.paginationEnabled.value&&(this.state.currentPage=1,this.emit("update:currentPage",this.state.currentPage))})),this.displayData=c((()=>this.paginationEnabled.value?function(t,e,s){if(t.length<=e||e<=0||s<=0)return t;const a=(s-1)*e,r=a+e;return[...t].slice(a,r)}(this.sortedData.value,this.state.pageSize,this.state.currentPage):this.sortedData.value)),u(this.displayData,(t=>{this.emit("totalItemsChanged",t.length)})),this.tableState=c((()=>({rows:this.displayData.value,rowsPrePagination:this.sortedData.value,selectedRows:this.state.selectedRows}))),u(this.tableState,(t=>{this.emit("stateChanged",t)}),{immediate:!0,deep:!0})}revealItem(t){if(!this.paginationEnabled.value)return!1;let e;return e="function"==typeof t?this.sortedData.value.findIndex(t):this.sortedData.value.indexOf(t),-1!==e&&(this.emit("update:currentPage",Math.ceil((e+1)/this.state.pageSize)),!0)}selectRow(t){"single"!==this.state.selectionMode?this.state.selectedRows.includes(t)||this.state.selectedRows.push(t):this.state.selectedRows=[t]}selectRows(t){for(const e of t)this.selectRow(e)}deselectRow(t){const e=this.state.selectedRows.indexOf(t);e>-1&&this.state.selectedRows.splice(e,1)}deselectRows(t){for(const e of t)this.deselectRow(e)}selectAll(){"single"!==this.state.selectionMode&&(this.state.selectedRows=[...this.state.data])}deselectAll(){this.state.selectedRows=[]}setSort({sortKey:t,customSort:e,sortOrder:s,sortId:a}){this.state.sortKey=t,this.state.customSort=e,this.state.sortOrder=s,this.state.sortId=a}syncProp(t,e,s=!1){u(e,(()=>{this.state[t]=e.value}),{immediate:!0,deep:s})}}const O=Symbol("store-key");var k=d({name:"VTable",props:{data:{type:Array,required:!0},filters:{type:Object,required:!1,default:()=>({})},currentPage:{type:Number,required:!1,default:void 0},pageSize:{type:Number,required:!1,default:void 0},selectionMode:{type:String,required:!1,default:"single",validator:t=>["single","multiple"].includes(t)},selectedClass:{required:!1,type:String,default:"vt-selected"},selectOnClick:{required:!1,type:Boolean,default:!0},hideSortIcons:{required:!1,type:Boolean,default:!1},sortIconPosition:{required:!1,type:String,default:"after"},sortHeaderClass:{type:String,required:!1,default:""}},emits:{stateChanged:t=>!0,totalPagesChanged:t=>!0,totalItemsChanged:t=>!0},setup(t,e){const s=new R(e.emit);h(O,s),s.syncProp("data",g(t,"data")),s.syncProp("filters",g(t,"filters"),!0),s.syncProp("currentPage",g(t,"currentPage")),s.syncProp("pageSize",g(t,"pageSize")),s.syncProp("selectionMode",g(t,"selectionMode")),s.syncProp("selectedClass",g(t,"selectedClass")),s.syncProp("selectOnClick",g(t,"selectOnClick")),s.syncProp("hideSortIcons",g(t,"hideSortIcons")),s.syncProp("sortIconPosition",g(t,"sortIconPosition")),s.syncProp("sortHeaderClass",g(t,"sortHeaderClass"));const a=c((()=>s.state.selectedRows.length===s.state.data.length));return{store:s,tableState:s.tableState,allRowsSelected:a,toggleAllRows:()=>a.value?s.deselectAll():s.selectAll(),selectAll:()=>s.selectAll(),deselectAll:()=>s.deselectAll(),selectRows:t=>s.selectRows(t),selectRow:t=>s.selectRow(t),deselectRows:t=>s.deselectRows(t),deselectRow:t=>s.deselectRow(t),revealItem:t=>s.revealItem(t),slots:e.slots}},render(){return p("table",{class:"v-table"},[p("thead",this.slots.head?this.slots.head({rows:this.tableState.rows,selectedRows:this.tableState.selectedRows,toggleAllRows:this.toggleAllRows,selectAll:this.selectAll,deselectAll:this.deselectAll,allRowsSelected:this.allRowsSelected}):void 0),p("tbody",this.slots.body?this.slots.body({rows:this.tableState.rows,selectedRows:this.tableState.selectedRows,selectRow:this.selectRow,deselectRow:this.deselectRow}):void 0)])}});function L(t){var e;const s={width:16,height:16,xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${t.vbWidth} ${t.vbHeight}`},a={fill:"currentColor",d:t.d,opacity:null!=(e=t.opacity)?e:1};return p("svg",i(i({attrs:s},s),{style:i({},t.disabled?{color:"#9CA3AF"}:{})}),[p("path",i({attrs:a},a))])}var I=d({name:"VTh",props:{sortKey:{type:[String,Function],required:!1,default:null},customSort:{type:[Function,Object],required:!1,default:null},defaultSort:{type:String,required:!1,validator:t=>["asc","desc",null].includes(t),default:null}},emits:["defaultSort","sortChanged"],setup(e,{emit:s,slots:a}){const r=f(O);if(!e.sortKey&&!e.customSort)throw new Error("Must provide the Sort Key value or a Custom Sort function.");const l="_"+Math.random().toString(36).substr(2,9),o=v(t.NONE);P((()=>{e.defaultSort&&(o.value="desc"===e.defaultSort?t.DESC:t.ASC,r.setSort({sortOrder:o.value,sortKey:e.sortKey,customSort:e.customSort,sortId:l}),y((()=>{s("defaultSort"),s("sortChanged",{sortOrder:o.value})})))}));const n=c((()=>{if(!r.state.hideSortIcons)return function(e){const s={width:16,height:16,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512"},a=()=>({fill:"currentColor",opacity:e===t.NONE||e===t.ASC?.4:1,d:"M41.05 288.05h238c21.4 0 32.1 25.9 17 41l-119 119a23.9 23.9 0 0 1-33.8.1l-.1-.1-119.1-119c-15.05-15.05-4.4-41 17-41z"}),r=()=>({fill:"currentColor",opacity:e===t.NONE||e===t.DESC?.4:1,d:"M24.05 183.05l119.1-119A23.9 23.9 0 0 1 177 64a.94.94 0 0 1 .1.1l119 119c15.1 15.1 4.4 41-17 41h-238c-21.45-.05-32.1-25.95-17.05-41.05z"});return p("svg",i({attrs:s},s),[p("g",[p("path",i({attrs:a()},a())),p("path",i({attrs:r()},r()))])])}(o.value)}));u((()=>r.state.sortId),(()=>{r.state.sortId!==l&&0!==o.value&&(o.value=0)}));const d=()=>{[t.DESC,t.NONE].includes(o.value)?o.value=t.ASC:o.value=t.DESC,r.setSort({sortOrder:o.value,sortKey:e.sortKey,customSort:e.customSort,sortId:l}),s("sortChanged",{sortOrder:o.value})},h=c((()=>{const t=[];return"before"!==r.state.sortIconPosition||r.state.hideSortIcons||t.push(n.value),a.default&&t.push(p("span",[a.default({sortOrder:o.value})])),"after"!==r.state.sortIconPosition||r.state.hideSortIcons||t.push(n.value),t}));return()=>p("th",i({class:"v-th"},w?{on:{click:d}}:{onClick:d}),[p("div",{class:r.state.sortHeaderClass},h.value)])}}),A=d({name:"VTr",props:{row:{type:Object,required:!0}},setup(t,{slots:e}){const s=f(O),a=c((()=>s.state.selectedRows.find((e=>e===t.row)))),r=c((()=>a.value?s.state.selectedClass:"")),l=c((()=>i({},s.state.selectOnClick?{cursor:"pointer"}:{}))),o=e=>{const r=e.target;r&&"td"===r.tagName.toLowerCase()&&(a.value?s.deselectRow(t.row):s.selectRow(t.row))};return()=>p("tr",i(i({class:r.value,style:l.value},s.state.selectOnClick?{onClick:o}:{}),{on:i({},s.state.selectOnClick?{click:o}:{})}),e.default?e.default({isSelected:a.value,toggle:()=>a.value?s.deselectRow(t.row):s.selectRow(t.row)}):[])}}),N=d({name:"VTPagination",props:{currentPage:{type:Number,required:!0},totalPages:{type:Number,required:!0},hideSinglePage:{required:!1,type:Boolean,default:!0},maxPageLinks:{required:!1,type:Number,default:NaN},boundaryLinks:{required:!1,type:Boolean,default:!1},directionLinks:{required:!1,type:Boolean,default:!0}},setup(t,{slots:e,emit:s}){const a=c((()=>isNaN(t.maxPageLinks)||t.maxPageLinks<=0?(()=>{const e=[];for(let s=1;s<=t.totalPages;s++)e.push({title:s.toString(),value:s});return e})():(()=>{const e=[],s=Math.ceil(t.totalPages/t.maxPageLinks),a=Math.ceil((t.currentPage||1)/t.maxPageLinks);let r=(a-1)*t.maxPageLinks+1;const l=Math.min(r+t.maxPageLinks-1,t.totalPages),o=l-r+1,i=t.maxPageLinks-o;a===s&&a>1&&i>0&&(r-=i),a>1&&e.push({title:"...",value:r-1});for(let n=r;n<=l&&!(n>t.totalPages);n++)e.push({title:n.toString(),value:n});return a<s&&e.push({title:"...",value:l+1}),e})())),r=e=>{e<1||e>t.totalPages||e===t.currentPage||s("update:currentPage",e)},l=()=>{t.currentPage?t.currentPage<t.totalPages&&s("update:currentPage",t.currentPage+1):s("update:currentPage",1)},o=()=>{t.currentPage?t.currentPage>1&&s("update:currentPage",t.currentPage-1):s("update:currentPage",1)},n=()=>{s("update:currentPage",1)},u=()=>{s("update:currentPage",t.totalPages)},d=(t,e,s,a=!1)=>p("li",{class:["page-item",{disabled:s,active:a}]},[p("a",i(i({class:"page-link",style:i({},s?{cursor:"not-allowed"}:{}),attrs:{href:"javascript:void(0)"},href:"javascript:void(0)"},s?{}:{onClick:e}),{on:i({},s?{}:{click:e})}),[t])]);return()=>{var s,i,c,h,g,f,v,P;if(t.hideSinglePage&&1===t.totalPages)return p("");const y=[];if(t.boundaryLinks){const a=L({vbWidth:512,vbHeight:512,d:"M34.5 239L228.9 44.7c9.4-9.4 24.6-9.4 33.9 0l22.7 22.7c9.4 9.4 9.4 24.5 0 33.9L131.5 256l154 154.7c9.3 9.4 9.3 24.5 0 33.9l-22.7 22.7c-9.4 9.4-24.6 9.4-33.9 0L34.5 273c-9.3-9.4-9.3-24.6 0-34zm192 34l194.3 194.3c9.4 9.4 24.6 9.4 33.9 0l22.7-22.7c9.4-9.4 9.4-24.5 0-33.9L323.5 256l154-154.7c9.3-9.4 9.3-24.5 0-33.9l-22.7-22.7c-9.4-9.4-24.6-9.4-33.9 0L226.5 239c-9.3 9.4-9.3 24.6 0 34z"}),r=1===t.currentPage,l=null!=(i=null==(s=e.firstPage)?void 0:s.call(e,{disabled:r}))?i:a;y.push(d(l,n,r))}if(t.directionLinks){const s=L({vbWidth:320,vbHeight:512,d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"}),a=1===t.currentPage,r=null!=(h=null==(c=e.previous)?void 0:c.call(e,{disabled:a}))?h:s;y.push(d(r,o,a))}for(const e of a.value)y.push(d(e.title,(()=>r(e.value)),!1,e.value===t.currentPage));if(t.directionLinks){const s=L({vbWidth:320,vbHeight:512,d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"}),a=t.currentPage===t.totalPages,r=null!=(f=null==(g=e.next)?void 0:g.call(e,{disabled:a}))?f:s;y.push(d(r,l,a))}if(t.boundaryLinks){const s=L({vbWidth:512,vbHeight:512,d:"M477.5 273L283.1 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.7-22.7c-9.4-9.4-9.4-24.5 0-33.9l154-154.7-154-154.7c-9.3-9.4-9.3-24.5 0-33.9l22.7-22.7c9.4-9.4 24.6-9.4 33.9 0L477.5 239c9.3 9.4 9.3 24.6 0 34zm-192-34L91.1 44.7c-9.4-9.4-24.6-9.4-33.9 0L34.5 67.4c-9.4 9.4-9.4 24.5 0 33.9l154 154.7-154 154.7c-9.3 9.4-9.3 24.5 0 33.9l22.7 22.7c9.4 9.4 24.6 9.4 33.9 0L285.5 273c9.3-9.4 9.3-24.6 0-34z"}),a=t.currentPage===t.totalPages,r=null!=(P=null==(v=e.lastPage)?void 0:v.call(e,{disabled:a}))?P:s;y.push(d(r,u,a))}return p("nav",{class:"vt-pagination"},[p("ul",{class:"pagination"},[y])])}}});S();var E={install(t,e={}){["hideSortIcons","sortIconPosition","sortHeaderClass"].forEach((t=>{e.hasOwnProperty(t)&&(k.props[t].default=e[t])})),t.component("VTable",k),t.component("VTh",I),t.component("VTr",A),t.component("VTPagination",N)}};export default E;
