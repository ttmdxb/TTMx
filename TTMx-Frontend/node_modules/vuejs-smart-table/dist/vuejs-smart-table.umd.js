var __defProp=Object.defineProperty,__hasOwnProp=Object.prototype.hasOwnProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,s)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,__assign=(e,t)=>{for(var s in t||(t={}))__hasOwnProp.call(t,s)&&__defNormalProp(e,s,t[s]);if(__getOwnPropSymbols)for(var s of __getOwnPropSymbols(t))__propIsEnum.call(t,s)&&__defNormalProp(e,s,t[s]);return e};!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vue-demi")):"function"==typeof define&&define.amd?define(["vue-demi"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["vuejs-smart-table"]=t(e.VueDemi)}(this,(function(e){"use strict";var t,s;function a(e,t){const s=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split(".");let a=e;for(const o of s){if(!(o in a))return;a=a[o]}return a}function o(e){return!Array.isArray(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function r(e,t){if(function(e){return e&&"function"==typeof e.custom}(t)&&!t.custom(t.value,e))return!1;if(!function(e){return Array.isArray(e.keys)}(t)||null===t.value||void 0===t.value||0===t.value.length)return!0;for(const s of t.keys){const o=a(e,s);if(null!=o){const e=Array.isArray(t.value)?t.value:[t.value];for(const s of e)if(t.exact){if(o.toString()===s.toString())return!0}else if(o.toString().toLowerCase().includes(s.toString().toLowerCase()))return!0}}return!1}(s=t||(t={}))[s.DESC=-1]="DESC",s[s.NONE=0]="NONE",s[s.ASC=1]="ASC";class l{constructor(s){this.state=e.reactive({data:[],filters:{},selectedRows:[],selectionMode:"single",selectOnClick:!0,selectedClass:"",hideSortIcons:!1,sortId:null,sortKey:null,customSort:null,sortOrder:t.NONE,currentPage:0,pageSize:void 0,sortIconPosition:"after",sortHeaderClass:""}),this.emit=s,this.filteredData=e.computed((()=>0===this.state.data.length?[]:0===Object.keys(this.state.filters).length?this.state.data:function(e,t){const s=[];for(const a of e){let e=!0;for(const s of Object.keys(t))if(!r(a,t[s])){e=!1;break}e&&s.push(a)}return s}(this.state.data,this.state.filters))),this.sortedData=e.computed((()=>{return(this.state.sortKey||this.state.customSort)&&0!==this.state.sortOrder?(e=this.filteredData.value,t=this.state.sortKey,s=this.state.customSort,r=this.state.sortOrder,[...e].sort(((e,l)=>{if("function"==typeof s)return s(e,l,r);let i,n;if(t?"function"==typeof t?(i=t(e,r),n=t(l,r)):(i=a(e,t),n=a(l,t)):(i=null,n=null),null==i&&(i=""),null==n&&(n=""),o(i)&&o(n))return(i-n)*r;const c=i.toString(),u=n.toString();return c.localeCompare(u)*r}))):this.filteredData.value;var e,t,s,r})),this.totalItems=e.computed((()=>this.filteredData.value.length)),this.totalPages=e.computed((()=>{return this.state.pageSize?(e=this.totalItems.value,t=this.state.pageSize,e<=t?1:Math.ceil(e/t)):0;var e,t})),e.watch(this.totalPages,(e=>{this.emit("totalPagesChanged",e)}),{immediate:!0}),this.paginationEnabled=e.computed((()=>this.state.pageSize));const l=e.computed((()=>this.paginationEnabled.value&&this.state.currentPage>this.totalPages.value));e.watch(l,(e=>{e&&this.paginationEnabled.value&&(this.state.currentPage=1,this.emit("update:currentPage",this.state.currentPage))})),this.displayData=e.computed((()=>this.paginationEnabled.value?function(e,t,s){if(e.length<=t||t<=0||s<=0)return e;const a=(s-1)*t,o=a+t;return[...e].slice(a,o)}(this.sortedData.value,this.state.pageSize,this.state.currentPage):this.sortedData.value)),e.watch(this.displayData,(e=>{this.emit("totalItemsChanged",e.length)})),this.tableState=e.computed((()=>({rows:this.displayData.value,rowsPrePagination:this.sortedData.value,selectedRows:this.state.selectedRows}))),e.watch(this.tableState,(e=>{this.emit("stateChanged",e)}),{immediate:!0,deep:!0})}revealItem(e){if(!this.paginationEnabled.value)return!1;let t;return t="function"==typeof e?this.sortedData.value.findIndex(e):this.sortedData.value.indexOf(e),-1!==t&&(this.emit("update:currentPage",Math.ceil((t+1)/this.state.pageSize)),!0)}selectRow(e){"single"!==this.state.selectionMode?this.state.selectedRows.includes(e)||this.state.selectedRows.push(e):this.state.selectedRows=[e]}selectRows(e){for(const t of e)this.selectRow(t)}deselectRow(e){const t=this.state.selectedRows.indexOf(e);t>-1&&this.state.selectedRows.splice(t,1)}deselectRows(e){for(const t of e)this.deselectRow(t)}selectAll(){"single"!==this.state.selectionMode&&(this.state.selectedRows=[...this.state.data])}deselectAll(){this.state.selectedRows=[]}setSort({sortKey:e,customSort:t,sortOrder:s,sortId:a}){this.state.sortKey=e,this.state.customSort=t,this.state.sortOrder=s,this.state.sortId=a}syncProp(t,s,a=!1){e.watch(s,(()=>{this.state[t]=s.value}),{immediate:!0,deep:a})}}const i=Symbol("store-key");var n=e.defineComponent({name:"VTable",props:{data:{type:Array,required:!0},filters:{type:Object,required:!1,default:()=>({})},currentPage:{type:Number,required:!1,default:void 0},pageSize:{type:Number,required:!1,default:void 0},selectionMode:{type:String,required:!1,default:"single",validator:e=>["single","multiple"].includes(e)},selectedClass:{required:!1,type:String,default:"vt-selected"},selectOnClick:{required:!1,type:Boolean,default:!0},hideSortIcons:{required:!1,type:Boolean,default:!1},sortIconPosition:{required:!1,type:String,default:"after"},sortHeaderClass:{type:String,required:!1,default:""}},emits:{stateChanged:e=>!0,totalPagesChanged:e=>!0,totalItemsChanged:e=>!0},setup(t,s){const a=new l(s.emit);e.provide(i,a),a.syncProp("data",e.toRef(t,"data")),a.syncProp("filters",e.toRef(t,"filters"),!0),a.syncProp("currentPage",e.toRef(t,"currentPage")),a.syncProp("pageSize",e.toRef(t,"pageSize")),a.syncProp("selectionMode",e.toRef(t,"selectionMode")),a.syncProp("selectedClass",e.toRef(t,"selectedClass")),a.syncProp("selectOnClick",e.toRef(t,"selectOnClick")),a.syncProp("hideSortIcons",e.toRef(t,"hideSortIcons")),a.syncProp("sortIconPosition",e.toRef(t,"sortIconPosition")),a.syncProp("sortHeaderClass",e.toRef(t,"sortHeaderClass"));const o=e.computed((()=>a.state.selectedRows.length===a.state.data.length));return{store:a,tableState:a.tableState,allRowsSelected:o,toggleAllRows:()=>o.value?a.deselectAll():a.selectAll(),selectAll:()=>a.selectAll(),deselectAll:()=>a.deselectAll(),selectRows:e=>a.selectRows(e),selectRow:e=>a.selectRow(e),deselectRows:e=>a.deselectRows(e),deselectRow:e=>a.deselectRow(e),revealItem:e=>a.revealItem(e),slots:s.slots}},render(){return e.h("table",{class:"v-table"},[e.h("thead",this.slots.head?this.slots.head({rows:this.tableState.rows,selectedRows:this.tableState.selectedRows,toggleAllRows:this.toggleAllRows,selectAll:this.selectAll,deselectAll:this.deselectAll,allRowsSelected:this.allRowsSelected}):void 0),e.h("tbody",this.slots.body?this.slots.body({rows:this.tableState.rows,selectedRows:this.tableState.selectedRows,selectRow:this.selectRow,deselectRow:this.deselectRow}):void 0)])}});function c(t){var s;const a={width:16,height:16,xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${t.vbWidth} ${t.vbHeight}`},o={fill:"currentColor",d:t.d,opacity:null!=(s=t.opacity)?s:1};return e.h("svg",__assign(__assign({attrs:a},a),{style:__assign({},t.disabled?{color:"#9CA3AF"}:{})}),[e.h("path",__assign({attrs:o},o))])}var u=e.defineComponent({name:"VTh",props:{sortKey:{type:[String,Function],required:!1,default:null},customSort:{type:[Function,Object],required:!1,default:null},defaultSort:{type:String,required:!1,validator:e=>["asc","desc",null].includes(e),default:null}},emits:["defaultSort","sortChanged"],setup(s,{emit:a,slots:o}){const r=e.inject(i);if(!s.sortKey&&!s.customSort)throw new Error("Must provide the Sort Key value or a Custom Sort function.");const l="_"+Math.random().toString(36).substr(2,9),n=e.ref(t.NONE);e.onMounted((()=>{s.defaultSort&&(n.value="desc"===s.defaultSort?t.DESC:t.ASC,r.setSort({sortOrder:n.value,sortKey:s.sortKey,customSort:s.customSort,sortId:l}),e.nextTick((()=>{a("defaultSort"),a("sortChanged",{sortOrder:n.value})})))}));const c=e.computed((()=>{if(!r.state.hideSortIcons)return function(s){const a={width:16,height:16,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512"},o=()=>({fill:"currentColor",opacity:s===t.NONE||s===t.ASC?.4:1,d:"M41.05 288.05h238c21.4 0 32.1 25.9 17 41l-119 119a23.9 23.9 0 0 1-33.8.1l-.1-.1-119.1-119c-15.05-15.05-4.4-41 17-41z"}),r=()=>({fill:"currentColor",opacity:s===t.NONE||s===t.DESC?.4:1,d:"M24.05 183.05l119.1-119A23.9 23.9 0 0 1 177 64a.94.94 0 0 1 .1.1l119 119c15.1 15.1 4.4 41-17 41h-238c-21.45-.05-32.1-25.95-17.05-41.05z"});return e.h("svg",__assign({attrs:a},a),[e.h("g",[e.h("path",__assign({attrs:o()},o())),e.h("path",__assign({attrs:r()},r()))])])}(n.value)}));e.watch((()=>r.state.sortId),(()=>{r.state.sortId!==l&&0!==n.value&&(n.value=0)}));const u=()=>{[t.DESC,t.NONE].includes(n.value)?n.value=t.ASC:n.value=t.DESC,r.setSort({sortOrder:n.value,sortKey:s.sortKey,customSort:s.customSort,sortId:l}),a("sortChanged",{sortOrder:n.value})},d=e.computed((()=>{const t=[];return"before"!==r.state.sortIconPosition||r.state.hideSortIcons||t.push(c.value),o.default&&t.push(e.h("span",[o.default({sortOrder:n.value})])),"after"!==r.state.sortIconPosition||r.state.hideSortIcons||t.push(c.value),t}));return()=>e.h("th",__assign({class:"v-th"},e.isVue2?{on:{click:u}}:{onClick:u}),[e.h("div",{class:r.state.sortHeaderClass},d.value)])}}),d=e.defineComponent({name:"VTr",props:{row:{type:Object,required:!0}},setup(t,{slots:s}){const a=e.inject(i),o=e.computed((()=>a.state.selectedRows.find((e=>e===t.row)))),r=e.computed((()=>o.value?a.state.selectedClass:"")),l=e.computed((()=>__assign({},a.state.selectOnClick?{cursor:"pointer"}:{}))),n=e=>{const s=e.target;s&&"td"===s.tagName.toLowerCase()&&(o.value?a.deselectRow(t.row):a.selectRow(t.row))};return()=>e.h("tr",__assign(__assign({class:r.value,style:l.value},a.state.selectOnClick?{onClick:n}:{}),{on:__assign({},a.state.selectOnClick?{click:n}:{})}),s.default?s.default({isSelected:o.value,toggle:()=>o.value?a.deselectRow(t.row):a.selectRow(t.row)}):[])}}),h=e.defineComponent({name:"VTPagination",props:{currentPage:{type:Number,required:!0},totalPages:{type:Number,required:!0},hideSinglePage:{required:!1,type:Boolean,default:!0},maxPageLinks:{required:!1,type:Number,default:NaN},boundaryLinks:{required:!1,type:Boolean,default:!1},directionLinks:{required:!1,type:Boolean,default:!0}},setup(t,{slots:s,emit:a}){const o=e.computed((()=>isNaN(t.maxPageLinks)||t.maxPageLinks<=0?(()=>{const e=[];for(let s=1;s<=t.totalPages;s++)e.push({title:s.toString(),value:s});return e})():(()=>{const e=[],s=Math.ceil(t.totalPages/t.maxPageLinks),a=Math.ceil((t.currentPage||1)/t.maxPageLinks);let o=(a-1)*t.maxPageLinks+1;const r=Math.min(o+t.maxPageLinks-1,t.totalPages),l=r-o+1,i=t.maxPageLinks-l;a===s&&a>1&&i>0&&(o-=i),a>1&&e.push({title:"...",value:o-1});for(let n=o;n<=r&&!(n>t.totalPages);n++)e.push({title:n.toString(),value:n});return a<s&&e.push({title:"...",value:r+1}),e})())),r=e=>{e<1||e>t.totalPages||e===t.currentPage||a("update:currentPage",e)},l=()=>{t.currentPage?t.currentPage<t.totalPages&&a("update:currentPage",t.currentPage+1):a("update:currentPage",1)},i=()=>{t.currentPage?t.currentPage>1&&a("update:currentPage",t.currentPage-1):a("update:currentPage",1)},n=()=>{a("update:currentPage",1)},u=()=>{a("update:currentPage",t.totalPages)},d=(t,s,a,o=!1)=>e.h("li",{class:["page-item",{disabled:a,active:o}]},[e.h("a",__assign(__assign({class:"page-link",style:__assign({},a?{cursor:"not-allowed"}:{}),attrs:{href:"javascript:void(0)"},href:"javascript:void(0)"},a?{}:{onClick:s}),{on:__assign({},a?{}:{click:s})}),[t])]);return()=>{var a,h,p,g,f,v,m,P;if(t.hideSinglePage&&1===t.totalPages)return e.h("");const w=[];if(t.boundaryLinks){const e=c({vbWidth:512,vbHeight:512,d:"M34.5 239L228.9 44.7c9.4-9.4 24.6-9.4 33.9 0l22.7 22.7c9.4 9.4 9.4 24.5 0 33.9L131.5 256l154 154.7c9.3 9.4 9.3 24.5 0 33.9l-22.7 22.7c-9.4 9.4-24.6 9.4-33.9 0L34.5 273c-9.3-9.4-9.3-24.6 0-34zm192 34l194.3 194.3c9.4 9.4 24.6 9.4 33.9 0l22.7-22.7c9.4-9.4 9.4-24.5 0-33.9L323.5 256l154-154.7c9.3-9.4 9.3-24.5 0-33.9l-22.7-22.7c-9.4-9.4-24.6-9.4-33.9 0L226.5 239c-9.3 9.4-9.3 24.6 0 34z"}),o=1===t.currentPage,r=null!=(h=null==(a=s.firstPage)?void 0:a.call(s,{disabled:o}))?h:e;w.push(d(r,n,o))}if(t.directionLinks){const e=c({vbWidth:320,vbHeight:512,d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"}),a=1===t.currentPage,o=null!=(g=null==(p=s.previous)?void 0:p.call(s,{disabled:a}))?g:e;w.push(d(o,i,a))}for(const e of o.value)w.push(d(e.title,(()=>r(e.value)),!1,e.value===t.currentPage));if(t.directionLinks){const e=c({vbWidth:320,vbHeight:512,d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"}),a=t.currentPage===t.totalPages,o=null!=(v=null==(f=s.next)?void 0:f.call(s,{disabled:a}))?v:e;w.push(d(o,l,a))}if(t.boundaryLinks){const e=c({vbWidth:512,vbHeight:512,d:"M477.5 273L283.1 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.7-22.7c-9.4-9.4-9.4-24.5 0-33.9l154-154.7-154-154.7c-9.3-9.4-9.3-24.5 0-33.9l22.7-22.7c9.4-9.4 24.6-9.4 33.9 0L477.5 239c9.3 9.4 9.3 24.6 0 34zm-192-34L91.1 44.7c-9.4-9.4-24.6-9.4-33.9 0L34.5 67.4c-9.4 9.4-9.4 24.5 0 33.9l154 154.7-154 154.7c-9.3 9.4-9.3 24.5 0 33.9l22.7 22.7c9.4 9.4 24.6 9.4 33.9 0L285.5 273c9.3-9.4 9.3-24.6 0-34z"}),a=t.currentPage===t.totalPages,o=null!=(P=null==(m=s.lastPage)?void 0:m.call(s,{disabled:a}))?P:e;w.push(d(o,u,a))}return e.h("nav",{class:"vt-pagination"},[e.h("ul",{class:"pagination"},[w])])}}});return e.install(),{install(e,t={}){["hideSortIcons","sortIconPosition","sortHeaderClass"].forEach((e=>{t.hasOwnProperty(e)&&(n.props[e].default=t[e])})),e.component("VTable",n),e.component("VTh",u),e.component("VTr",d),e.component("VTPagination",h)}}}));
